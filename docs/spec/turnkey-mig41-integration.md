# 財政部 Turnkey 系統 MIG 4.1 整合與加值中心責任

## 一、Turnkey 系統申報流程總覽

1. **發票資料準備（加值中心責任）**
   - 依 MIG 4.1 最新規範產生合法 XML 檔案（訊息類型、欄位、格式皆須符合 XSD）。
   - 訊息類型已合併，原 C0401、A0401、C0501、C0701 等已整合為 FXXX（如 F0401、F0501 等），請依 MIG 4.1 異動紀錄調整。
   - 檔案命名、目錄結構須依 Turnkey 系統規定（如 /INBOX、/OUTBOX）。

2. **檔案放置（加值中心責任）**
   - 產生的 XML 檔案放置於 Turnkey 系統指定目錄（如 /INBOX）供系統排程收送。
   - 不需自行加解密、簽章，這些由 Turnkey 系統自動處理。

3. **排程收送（Turnkey 系統責任）**
   - Turnkey 依排程自動收取 /INBOX 目錄下 XML 檔案，完成加密、簽章、傳送。
   - 回饋檔（ACK/RSP）自動放置於 /OUTBOX 目錄，由加值中心定時讀取。

4. **結果解析（加值中心責任）**
   - 解析回饋 XML，取得申報結果、錯誤碼、訊息。
   - 通知業者（Portal、API、Email）。

---

## 二、加值中心系統責任重點

- 僅需產出合法的 MIG 4.1 XML 檔案，並依規定命名、放置目錄。
- 不需自行加解密、簽章、傳送，這些由 Turnkey 系統自動完成。
- 需依 MIG 4.1 最新異動紀錄，正確處理訊息類型（如 FXXX 合併規則）。
- 需定時讀取 /OUTBOX 回饋檔，解析結果並通知業者。

---

## 三、MIG 4.1 訊息類型合併說明

- MIG 4.1 將原 C0401、A0401、C0501、C0701 等訊息類型合併為 FXXX 類型。
- 例如：
  - F0401：發票開立
  - F0501：折讓
  - F0701：退貨
- 詳細欄位、格式請參考 MIG 4.1 XSD 及異動紀錄。

---

## 四、Turnkey 系統目錄與排程

| 目錄      | 用途           | 加值中心責任 |
|-----------|----------------|--------------|
| /INBOX    | 上傳申報檔案   | 產生 XML 並放置 |
| /OUTBOX   | 接收回饋檔案   | 讀取結果並解析 |
| /ERROR    | 異常檔案       | 追蹤修正      |

- 檔案收送由 Turnkey 系統排程自動執行。

---

## 五、參考與建議

- 請務必依 MIG 4.1 最新 XSD、異動紀錄設計 XML 結構。
- 加值中心僅需專注於資料合法性、格式正確性，安全性由 Turnkey 系統保障。
- 若需查詢異動紀錄，請參考財政部官方 MIG 4.1 文件。

---

> 本文件僅針對加值中心系統責任與 Turnkey 整合重點，若需技術細節或 XSD 範例，請另行補充。
